<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
	
		<script id="vshader" type="x-shader/x-vertex">
			uniform mat4 u_MVPMatrix;
			uniform mat4 u_NormalMatrix;
			uniform vec3 u_LightDirection;
						
			attribute vec3 a_Normal;
			attribute vec4 a_TexCoord;
			attribute vec4 a_Position;
			
			varying float v_Dot;
			varying vec2 v_TexCoord;
			
			void main()
			{
				gl_Position = mvpMatrix;
				v_TexCoord = a_TexCoord.st;
				
				vec4 transNormal = u_NormalMatrix * vec4(a_Normal, 1);
				v_Dot = max(dot(transNormal.xyz, lightDirection), 0.0);
			}
		</script>
		
		<script id="fshader" type="x-shader/x-fragment">
			precision mediump float;
			
			uniform sampler2D u_Sampler2D;
			
			varying float v_Dot;
			varying vec2 v_TexCoord;
			
			void main()
			{
				vec2 texCoord = vec2(v_TexCoord.s, 1.0 - v_TexCoord.t);
				vec4 color = texture2D(u_Sampler2D, texCoord);
				
				color += vec4(0.1, 0.1, 0.1, 1.0);
				
				gl_FragColor = vec4(color.xyz * v_Dot, color.a);
			}
		</script>
		
		<script type="text/javascript" src="webgl-debug.js"></script>
		
		<script type="text/javascript">
			function init()
			{
				var gl = initWebGL("example");
			
				if(!gl)
					return;
				
				g.program = simpleSetup(gl, "vshader", "fshader", ["vNormal", "vColor", "vPosition"], [0, 0, 0, 1], 10000);

				g.box = makeBox(gl);
				
				return gl;
			}
			
			init();
		</script>
	</head>

	<body>
	
		<canvas id="example" style="width: 300px; height: 300px; border: 1px solid black;">
		</canvas>
	
	</body>
</html>